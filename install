#!/bin/bash

if docker version; 
then
  echo "Docker installed, ok"
else
  curl -sSL https://get.docker.com/ | sh
fi

curl -sSL https://get.haskellstack.org/ | sh
stack update
stack upgrade

git clone ssh://git@gitlab.iscpif.fr:20022/gargantext/haskell-gargantext.git

cd haskell-gargantext

git clone ssh://git@gitlab.iscpif.fr:20022/gargantext/purescript-gargantext

mkdir deps
cd deps
git clone ssh://git@gitlab.iscpif.fr:20022/gargantext/clustering-louvain.git
git clone https://github.com/np/servant-job.git
git clone https://github.com/np/patches-map
git clone https://gitlab.com/npouillard/patches-class.git
cd ..

~/.local/bin/stack docker pull
~/.local/bin/stack --docker setup
~/.local/bin/stack --docker build
~/.local/bin/stack --docker install

